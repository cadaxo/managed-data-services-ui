<mvc:View controllerName="com.cadaxo.cmds.controller.App"
    xmlns:mvc="sap.ui.core.mvc" xmlns:core="sap.ui.core" xmlns="sap.m" xmlns:l="sap.ui.layout" xmlns:g="sap.suite.ui.commons.networkgraph">
	<Shell id="shell" appWidthLimited="false">
		<App id="app">
			<pages>
				<Page id="page" title="{i18n>title}">
					<customHeader>
						<Bar>
							<contentLeft>
								<Image height="40px" src="{imageModel>/cadaxoLogo}"></Image>
								<Text class="cadaxoHeaderText" text = "Managed Data Services"></Text>
							</contentLeft>
						</Bar>	
					</customHeader>
					<content>
						<FlexBox fitContainer="true" renderType="Bare" wrap="Wrap" id="graphWrapper">
						
							<g:Graph enableWheelZoom="false"
								enableZoom="true"
								nodes="{graphModel>/nodes}"
								id="graph"
								lines="{graphModel>/links}"
								noDataText="{i18n>noData}"
								width="auto"
							
								statuses="{graphModel>/statuses}">
								<g:statuses>
									<g:Status key="{graphModel>StatusKey}"
									title="{graphModel>Description}"
									backgroundColor="{graphModel>Color2}"
									contentColor="{graphModel>Color1}">
									</g:Status>
								</g:statuses>
								<g:nodes>
									<g:Node key="{graphModel>DsId}" title="{graphModel>ObjectName}"
										icon="{
												path: 'graphModel>ObjectType',
												formatter: '.formatter.setNodeIcon'
										}"  
										showActionLinksButton="false"
										showDetailButton="false"
										showExpandButton="false"
										shape="Circle"
										width="300"
										status="{parts: [
											'graphModel>ObjectType', 'graphModel>ObjectState'
											],
											formatter: '.formatter.setNodeStatus'
										}"
										press="onNodePressed">
										<g:actionButtons>
											<g:ActionButton
													icon="sap-icon://navigation-left-arrow"
													title="Show parent nodes"
													position="Left"
													press="leftExpandPressed"/>
									
											<g:ActionButton
													icon="sap-icon://navigation-right-arrow"
													title="Show child nodes"
													press="rightExpandPressed"/>
										</g:actionButtons>
									</g:Node>

								</g:nodes>
								<g:lines>
								<g:Line 
									from="{graphModel>ObjectId1}" 
									to="{graphModel>ObjectId2}"
									press="linePressed"
									status="{parts: [
											'graphModel>Type'
											],
											formatter: '.formatter.setLineStatus'
										}"
									title="{graphModel>Description}">
								</g:Line>
							</g:lines>
						
							</g:Graph>
							<Panel visible="false" width="40%" height="100%" id="sideBar-panel">
								<headerToolbar>
									<OverflowToolbar>
										<Title text="{ObjectName}"/>
										<Title text="- {Description}"/>
										<ToolbarSpacer />
										<Button press="whereUsedPressed" id="btn-show-where-used" text="Show Where Used" enabled="false" />
										<Button press="viewInBrowserPressed" icon="sap-icon://detail-view" tooltip="Show source in browser" enabled="{=${ActionLink/Display}.length !== 0}">
											<customData>
												<core:CustomData key="url" value="{ActionLink/Display}"/>
											</customData>
										</Button>
										<Button press="viewInAdtPressed" icon="sap-icon://edit-outside" tooltip="Show source in ADT" enabled="{=${ActionLink/Edit}.length !== 0}">
											<customData>
												<core:CustomData key="url" value="{ActionLink/Edit}"/>
											</customData>										
										</Button>
									</OverflowToolbar>
								</headerToolbar>
								<content>
									<!--FlexBox>
										<items>
											<Text class="sapColumnCustomHeader" text="Type:"></Text>
										</items>
									</FlexBox>
									<FlexBox>
										<items>
											<Text class="sapColumnCustomHeader" text="Description:"></Text>
										</items>
									</FlexBox-->
									<TabContainer id="tabs" itemSelect="tabChanged">
										<items>
											<TabContainerItem name="Fields">
												<content>
													<FlexBox id="fields-header">
														<items>
															<Text id="fields-header-column1" width="170px" text="Column">
															<layoutData>
																<FlexItemData growFactor="1" />
															</layoutData>
															</Text>
															<Text id="fields-header-column2" width="145px" text="Data Element">
															<layoutData>
																<FlexItemData growFactor="1" />
															</layoutData>
															</Text>
															<Text id="fields-header-column3" width="100px" text="Data Type">
															<layoutData>
																<FlexItemData growFactor="1" />
															</layoutData>
															</Text>
															<Text id="fields-header-column4" width="150px" text="Description">
															<layoutData>
																<FlexItemData growFactor="1" />
															</layoutData>
															</Text>
														</items>
													</FlexBox>
													<Tree itemPress="fieldPressed" id="tree-fields" items="{nodeDetail>/fields}"
													mode="SingleSelectMaster"
													>
														<CustomTreeItem type="Active">
															<customData>
																<core:CustomData key="fieldName" value="{nodeDetail>text}"/>
															</customData>
															<FlexBox alignItems="Start" width="100%">
																<items>
																	<core:Icon class="cadaxoCustomIcon" src="sap-icon://key" size="1rem" visible="{= ${nodeDetail>isKey} === true }" 
																	tooltip="Primary Key" />
																	<Text width="150px" text="{parts: [
																		'nodeDetail>text', 'nodeDetail>isWhereUsed'
																		], formatter:'externFormatter.setHighlighted'}">
																	<layoutData>
																		<FlexItemData growFactor="1" />
																	</layoutData>
																	</Text>
																	
																	<Text visible="{= ${nodeDetail>isField} === true }" width="145px" text="{nodeDetail>dataelement}">
																	<layoutData>
																		<FlexItemData growFactor="1" />
																	</layoutData>
																	</Text>				
																	<Text visible="{= ${nodeDetail>isField} === true }" width="90px" text="{nodeDetail>datatype}">
																	<layoutData>
																		<FlexItemData growFactor="1" />
																	</layoutData>
																	</Text>																														
																	<Text visible="{= ${nodeDetail>isField} === true }" width="150px" text="{nodeDetail>description}">
																	<layoutData>
																		<FlexItemData growFactor="1" />
																	</layoutData>
																	</Text>	
																	<Text visible="{= ${nodeDetail>isField} === false }" width="100%" textAlign="Begin" text="{nodeDetail>value}" >
																	<layoutData>
																		<FlexItemData growFactor="1" />
																	</layoutData>
																	</Text>
																</items>
															</FlexBox>
														</CustomTreeItem>
													</Tree>
												</content>
											</TabContainerItem>
											<TabContainerItem name="Header Annotations">
												<content>
													<Table id="headerAnnotations"
														inset="false"
														items="{nodeDetail>/headerAnnotations}">
														<columns>
															<Column width="70%">
																<Text text="Name" />
															</Column>
															<Column width="30%">
																<Text text="Value" />
															</Column>
														</columns>
														<items>
															<ColumnListItem>
																<cells>
																	<Text text="{nodeDetail>text}"/>
																	<Text text="{nodeDetail>value}" />
																</cells>
															</ColumnListItem>
														</items>
													</Table>
												</content>
											</TabContainerItem>
											<TabContainerItem name="Parameters">
												<content>
														<Table id="parameters"
															inset="false"
															items="{
																path: 'nodeDetail>/parameters',
																sorter: {
																	path: 'Position'
																}
															}">
															<columns>
																<Column width="60%">
																	<Text text="Parameter" />
																</Column>
																<Column width="20%">
																	<Text text="Data Element" />
																</Column>
																<Column width="20%">
																	<Text text="Data Type" />
																</Column>
															</columns>
															<items>
																<ColumnListItem>
																	<cells>
																		<Text text="{nodeDetail>Description}"/>
																		<Text text="{nodeDetail>DataElement}"/>
																		<Text text="{nodeDetail>Datatype}" />
																	</cells>
																</ColumnListItem>
															</items>
														</Table>
												</content>
											</TabContainerItem>
										</items>
									</TabContainer>
								</content>
						
							</Panel>
						</FlexBox>
          			</content>
				</Page>
			</pages>
		</App>
	</Shell>
</mvc:View>